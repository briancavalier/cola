<!DOCTYPE HTML>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<title>ObjectAdapter test</title>

<script src="util/doh/runner.js"></script>
<script src="test-config.js"></script>

<script type="text/javascript">
require(['cola/ObjectAdapter', 'domReady!'], function(ObjectAdapter) {

	doh.register('the basics', [
		function getOptions (doh) {
			var bindings = {}, adaptedObject;
			adaptedObject = new ObjectAdapter({}, {
				bindings: bindings
			});
			doh.assertEqual(bindings, adaptedObject.getOptions().bindings);
		},
		function canHandle (doh) {
			doh.assertFalse(ObjectAdapter.canHandle(), 'undefined');
			doh.assertFalse(ObjectAdapter.canHandle(null), 'null');
			doh.assertFalse(ObjectAdapter.canHandle(function(){}), 'function');
			doh.assertFalse(ObjectAdapter.canHandle([]), 'array');
			doh.assertTrue(ObjectAdapter.canHandle({}), 'object');
			doh.assertFalse(ObjectAdapter.canHandle(document.body), 'DOMNode');
		}
	]);
	doh.register('events', [
		function watch (doh) {
			var obj, adapted, dfd;
			obj = { first: 'Fred', last: 'Fintstone' };
			adapted = new ObjectAdapter(obj);
			dfd = new doh.Deferred();
			adapted.watch('first', function (name, value) {
				dfd.callback(value == 'Martha' && name == 'first');
			});
			adapted.set('first', 'Martha');
			return dfd;
		},
		function set (doh) {
			var obj, adapted, dfd;
			obj = { first: 'Fred', last: 'Flintstone' };
			adapted = new ObjectAdapter(obj);
			dfd = new doh.Deferred();
			adapted.watchAll(function (name, value) {
				dfd.callback(value == 'Astaire' && name == 'last');
			});
			adapted.set('last','Astaire');
			return dfd;
		}
	]);

	doh.run();

});
</script>
</head>
<body>
</body>
</html>