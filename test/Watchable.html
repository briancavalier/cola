<!DOCTYPE HTML>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<title>Watchable test</title>

<script src="util/doh/runner.js"></script>
<script src="test-config.js"></script>

<script type="text/javascript">
require(['cola/Watchable'], function(Watchable) {

	doh.register('the basics', [
		function get (doh) {
			var watchableObject;
			watchableObject = new Watchable({
				first: 'Fred'
			});
			doh.assertEqual('Fred', watchableObject.get('first'));
		},
		function set (doh) {
			var watchableObject;
			watchableObject = new Watchable({
				first: 'Fred'
			});
			watchableObject.set('first', 'Martha');
			doh.assertEqual('Martha', watchableObject.get('first'));
		}
	]);
	doh.register('events', [
		function watch (doh) {
			var obj, watched, dfd;
			obj = { first: 'Fred', last: 'Flintstone' };
			watched = new Watchable(obj);
			dfd = new doh.Deferred();
			watched.watch('first', function (value, name) {
				dfd.callback(value == 'Martha' && name == 'first');
			});
			watched.set('first', 'Martha');
			return dfd;
		},
		function watchAll (doh) {
			var obj, watched, dfd;
			obj = { first: 'Fred', last: 'Flintstone' };
			watched = new Watchable(obj);
			dfd = new doh.Deferred();
			watched.watch('*', function (value, name) {
				dfd.callback(value == 'Astaire' && name == 'last');
			});
			watched.set('last', 'Astaire');
			return dfd;
		}
	]);

	doh.run();

});
</script>
</head>
<body>
</body>
</html>