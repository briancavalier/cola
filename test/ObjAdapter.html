<!DOCTYPE HTML>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<title>ObjAdapter test</title>

<script src="util/doh/runner.js"></script>
<script src="test-config.js"></script>

<script type="text/javascript">
require(['cola/ObjAdapter'], function(ObjAdapter) {

	doh.register('the basics', [
		function resolveName (doh) {
			var adaptedObject;
			adaptedObject = new ObjAdapter({});
			doh.assertEqual('description', adaptedObject.resolveName('description'));
		},
		function setOptions (doh) {
			var options = {}, adaptedObject;
			adaptedObject = new ObjAdapter({});
			adaptedObject.setOptions(options);
			doh.assertEqual(options, adaptedObject._options);
		},
		function canHandle (doh) {
			doh.assertFalse(ObjAdapter.canHandle(), 'undefined');
			doh.assertFalse(ObjAdapter.canHandle(null), 'null');
			doh.assertFalse(ObjAdapter.canHandle(function(){}), 'function');
			doh.assertTrue(ObjAdapter.canHandle([]), 'array');
			doh.assertTrue(ObjAdapter.canHandle({}), 'object');
		}
	]);
	doh.register('events', [
		function watchProp (doh) {
			var obj, adapted, dfd;
			obj = { first: 'Fred', last: 'Fintstone' };
			adapted = new ObjAdapter(obj);
			dfd = new doh.Deferred();
			adapted.watchProp('first', function (value, name) {
				dfd.callback(value == 'Martha' && name == 'first');
			});
			adapted.propChanged('Martha', 'first');
			return dfd;
		},
		function propChanged (doh) {
			var obj, adapted, dfd;
			obj = { first: 'Fred', last: 'Flintstone' };
			adapted = new ObjAdapter(obj);
			dfd = new doh.Deferred();
			adapted.watchAllProps(function (value, name) {
				dfd.callback(value == 'Astaire' && name == 'last');
			});
			adapted.propChanged('Astaire', 'last');
			return dfd;
		}
	]);

	doh.run();

});
</script>
</head>
<body>
</body>
</html>